<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.18.0/css/mdb.min.css" rel="stylesheet">

  <link rel="stylesheet" href="/static/style.css">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <title>Django Highcharts Example</title>
</head>
<body>
  <a href="{% url 'home' %}">Return to homepage</a>
  <div id="container"></div>
  <script src="https://code.highcharts.com/highcharts.src.js"></script>
  <script>
    Highcharts.chart('container', {
        title: {
            text: '좌석 등급에 따른 타이타닉 생존/비 생존 인원 및 생존율'
        },
        xAxis: {
            categories: [
              {% for entry in dataset %}
                '{{ entry.ticket_class }} 등석'{% if not forloop.last %}, {% endif %}
              {% endfor %}
            ]
        },
        yAxis: [{
            min: 0,
            title: {
                text: '인원'
            }
        }, {
            title: {
                text: '생존율'
            },
            label: { format: '{value} %' },
            opposite: true
        }],
        legend: {
            shadow: false
        },
        tooltip: {
          shared: true
        },
        plotOptions: {
          column: {
            grouping: false,
            shadow: false,
            borderWidth: 0
          }
        },
        series: [{
            type: 'column',
            name: '생존',
            data: [
              {% for entry in dataset %}
                {{ entry.survived_count }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            ],
            color: 'green'
        }, {
            type: 'column',
            name: '비 생존',
            data: [
              {% for entry in dataset %}
                {{ entry.not_survived_count }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            ],
            color: 'red'
        }, {
            type: 'spline',
            name: '생존율',
            data: [
              {% for entry in dataset %}
                {{ entry.survier_rate }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            ],
            color: 'blue',
            tooltip: {valueSuffix: ' %'}
        }]
    });
  </script>
</body>

</html>